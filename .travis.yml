language: ruby

addons:
  firefox: "58.0"

sudo: false

bundler_args: ''

before_install:
  - gem install bundler -v 1.16.1

before_script: "bundle exec rake test:ci:install"

script: "bundle exec rake test:ci"

### Build Matrix

max_ruby_version: &max_ruby 2.3.3

rvm:
  - 2.2.5
  - *max_ruby
  - ruby-head

global:
  gemfile:
    - Gemfile

# Run unit tests across all Ruby versions
env:
  - UNITS=true

matrix:
  allow_failures:
    - rvm: ruby-head

  # Integration tests
  include:
    - env: RAILS_VERSION=4.2
      rvm: *max_ruby

    - env: RAILS_VERSION=5.0
      rvm: *max_ruby

